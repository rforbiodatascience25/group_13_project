---
title: "Analyzing Neurotransmitter Receptors & Protein Sequences"
author: Ákos Kimpián, Joshua Lembeck, Elvin Kalinowski, Mikel Garcia Amez, Marcel Skumantz
date: 02-12-2025
format: 
  revealjs:
    slide-number: true
editor: visual
embed-resources: true
---

# Introduction

-   @Mikel add information here

## Data Set info

## Channels

# Material & Methods

```         
- Dirtying + Cleaning
- EDA
- PCA
- Prediction
```

## Dirtying -- Cleaning


::: {.columns}
::: {.column width="25%"}
1. Split data
:::
::: {.column width="75%"}
Combine via .row_id
:::
:::


::: {.columns}
::: {.column width="25%"}
2. Insert missing values
:::
::: {.column width="37%"}
![](../results/figures/missingness_matrix.png)
:::
::: {.column width="37%"}
- Random missingness
- Imputation sensible
:::
:::


::: {.columns}
::: {.column width="25%"}
3. Insert outliers
:::
::: {.column width="37%"}
![](../results/figures/boxplots_outliers_dirty.png)
:::
::: {.column width="37%"}
![](../results/figures/boxplots_outliers_clean.png)
:::
:::



## EDA

## Prediction preprocessing

-   AA composition variables (`aa_*`) as features
-   Receptor classes using pattern-based annotation of `Protein_Name` as target
    -   Cys-loop receptors
    -   Ionotropic glutamate receptors
    -   Other ionotropic receptors

## PCA

::::: columns
::: {.column width="50%"}
-   Examine structure before modelling
-   using tidymodels
-   PC1 \<-\> PC2 scatter
:::

::: {.column width="50%"}
``` r
#...
pca_rec <- recipe(~., data = prediction_df) |>
  update_role(Protein_ID, Receptor_class, 
              new_role = "id") |>
  step_normalize(all_predictors()) |>
  step_pca(all_predictors())
#...
```
:::
:::::

## Predictive Modeling

::::: columns
::: {.column width="50%"}
-   Stratified $80$/$20$ train–test split to maintain class balance
-   Random Forest classifier with $1000$ trees
-   Basic Metrics and Mean Decrease Gini (MDG) as feature importance
:::

::: {.column width="50%"}
``` r
#...
pca_rec <- recipe(~., data = prediction_df) |>
  update_role(Protein_ID, Receptor_class, 
              new_role = "id") |>
  step_normalize(all_predictors()) |>

rf_spec <- rand_forest(trees = 1000) |>
  set_engine("randomForest") |>
  set_mode("classification")
#...
```
:::
:::::

# Results


## PCA and classification results

::::: columns

::: {.column width="50%"}
![](../results/figures/pca_plot.png)
:::
::: {.column width="50%"}
![](../results/figures/metrics_plot.png)
:::
:::::


## Length and weight correlation analysis

::::: columns
::: {.column width="50%"}
![](../results/figures/lm_plot.png)
:::

::: {.column width="50%"}
![](../results/figures/outlier_comp_deviation_plot.png)
:::
:::::

# Discussion (Joshua)

## Biological Interpretation

:::: columns
::: {.column width="45%"}


- Valine, Glycine, Tryptophan, Serine, and Proline are most discriminative
- Proline and Glycine disrupt α-helices and β-sheets
- Proline is dominant in loops and turns

:::

::: {.column width="55%"}

![](../results/figures/aa_importance_plot.png)

:::
::::

## Limitations and Future Directions

-   Success of the analysis?
    -   prediction of Cys-loop and Glutamate ion receptors very accurate
    -   other receptors are not well predicted due to lack of representation in the data set
    -   
-   What could be explored more in detail
    -   test model against larger variety of background proteins
